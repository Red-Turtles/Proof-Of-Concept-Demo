<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="csrf-token" content="{{ csrf_token() }}" />
  <title>WildID Quests</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-pIVpCq5/7Y6F+h4Jk3EL5PyB4tS6Tn6kki0eM7F9j1WFzsDmJx7HwXKc7aYidIyh67tKi37gZoe1zYx4V5lrkg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body class="community-page">
  <nav class="header-nav">
    <div class="nav-container">
      <div class="logo">
        <span class="logo-icon">üçÉ</span>
        <span class="logo-text">WildID</span>
      </div>
      <div class="nav-links">
        <a href="/" class="nav-link" data-transition="true">Home</a>
        <a href="/discovery" class="nav-link" data-transition="true">Discovery</a>
        <a href="/community" class="nav-link" data-transition="true">Community</a>
        <a href="/community/map" class="nav-link" data-transition="true">Community Map</a>
        <a href="/quests" class="nav-link active" data-transition="true">Quests</a>
        {% if current_user %}
        <div class="profile-menu">
          <a href="/profile" class="nav-link profile-toggle" data-transition="true">Profile</a>
          <div class="profile-dropdown">
            <a href="/profile" data-transition="true">View Profile</a>
            <a href="/history" data-transition="true">History</a>
            <hr class="dropdown-divider" />
            <form action="/auth/logout" method="post" class="logout-form">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
              <button type="submit">Sign Out</button>
            </form>
          </div>
        </div>
        {% else %}
        <a href="/auth/login" class="nav-link" data-transition="true">Sign In</a>
        {% endif %}
      </div>
    </div>
  </nav>

  <main class="community-map-wrapper">
    <section class="community-map-hero">
      <div>
        <h1>WildID Quest Board</h1>
        <p>Take on special identification challenges to earn exclusive badges. Upload through Discovery, and we‚Äôll automatically check your progress.</p>
      </div>
      <div class="map-controls">
        <a href="/discovery" class="hero-btn primary" data-transition="true">
          <svg class="icon icon-lg" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M5 20h14v-2H5v2zm7-16L5.33 12h3.67v4h6v-4h3.67L12 4z" fill="currentColor"/>
          </svg>
          Upload for a Quest
        </a>
        <a href="/community" class="hero-btn secondary" data-transition="true">
          <svg class="icon icon-lg" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M16 11a4 4 0 1 0-3.76-5.3 4 4 0 0 0-5.48 0A4 4 0 1 0 8 11c-4 0-7 2-7 5v3h22v-3c0-3-3-5-7-5z" fill="currentColor"/>
          </svg>
          Visit Community Feed
        </a>
      </div>
    </section>

    <section class="quest-grid">
      {% if not current_user %}
      <div class="map-empty-state">
        <span style="font-size:48px;">üîê</span>
        <h2>Sign in to track quest progress</h2>
        <p>Create an account or sign in to earn badges for your wildlife adventures.</p>
        <a href="/auth/login" class="hero-btn primary" data-transition="true">Sign In</a>
      </div>
      {% endif %}
      {% if quests %}
      {% for quest in quests %}
      {% set definition = quest.definition %}
      <article class="quest-card {% if quest.achieved %}quest-card--earned{% endif %}">
        <header>
          <span class="quest-icon">{{ definition.icon }}</span>
          <h2>{{ definition.name }}</h2>
          {% if quest.achieved %}
            <span class="quest-status">Completed{% if quest.awarded_at %} ‚Ä¢ {{ quest.awarded_at.strftime('%b %d, %Y') }}{% endif %}</span>
          {% else %}
            <span class="quest-status quest-status--active">Active</span>
          {% endif %}
        </header>
        <p class="quest-description">{{ definition.description }}</p>
        <ul class="quest-requirements">
          <li>
            <strong>Requirement:</strong>
            {% if definition.target_common_name %}
              Identify a <em>{{ definition.target_common_name.title() }}</em>
            {% elif definition.target_species %}
              Identify <em>{{ definition.target_species.title() }}</em>
            {% else %}
              Complete the challenge objective.
            {% endif %}
          </li>
          <li><strong>Progress:</strong> {{ quest.progress }}/{{ definition.threshold }}</li>
        </ul>
        <div class="quest-actions">
          <a href="/discovery" class="hero-btn primary" data-transition="true">Upload Now</a>
          <a href="/community/new" class="hero-btn tertiary" data-transition="true">Share with Community</a>
        </div>
      </article>
      {% endfor %}
      {% else %}
      <div class="map-empty-state">
        <span style="font-size:48px;">üéØ</span>
        <h2>No quests available</h2>
        <p>Check back soon for new challenges from the WildID team.</p>
      </div>
      {% endif %}
    </section>
  </main>

  <footer>
    <div class="footer-content">
      <p>WildID ‚Ä¢ Wildlife Identification ‚Ä¢ Auto file cleanup ‚Ä¢ Interactive habitat mapping</p>
    </div>
  </footer>

  <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>

