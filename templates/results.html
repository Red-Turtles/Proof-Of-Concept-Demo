<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Animal Species Identifier - Results</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
</head>
<body>
  <header>
    <h1>🐾 Animal Identifier</h1>
    <p>AI-powered species identification results</p>
  </header>
  <main class="container">
    
    <!-- Results Hero Section -->
    <section class="results-hero">
      <div class="hero-content">
        <div class="hero-icon">
          {% if result.is_animal %}
            🎯
          {% else %}
            ❓
          {% endif %}
        </div>
        <div class="hero-text">
          <h2 class="hero-title">
            {% if result.is_animal and result.common_name and result.common_name != "Unknown" %}
              {{ result.common_name }}
            {% elif result.is_animal and result.species and result.species != "Unknown" %}
              {{ result.species }}
            {% elif result.is_animal %}
              Animal Detected
            {% else %}
              No Animal Found
            {% endif %}
          </h2>
          <p class="hero-subtitle">
            {% if result.is_animal %}
              Species identification complete
            {% else %}
              This image doesn't appear to contain an animal
            {% endif %}
          </p>
        </div>
      </div>
      
      <!-- Confidence Indicator -->
      {% if result.is_animal %}
      <div class="confidence-indicator">
        {% set confidence = result.confidence or "Unknown" %}
        {% if confidence.lower() == "high" %}
          <div class="confidence-badge high">
            <span class="confidence-icon">🟢</span>
            <span class="confidence-text">High Confidence</span>
          </div>
        {% elif confidence.lower() == "medium" %}
          <div class="confidence-badge medium">
            <span class="confidence-icon">🟡</span>
            <span class="confidence-text">Medium Confidence</span>
          </div>
        {% elif confidence.lower() == "low" %}
          <div class="confidence-badge low">
            <span class="confidence-icon">🔴</span>
            <span class="confidence-text">Low Confidence</span>
          </div>
        {% else %}
          <div class="confidence-badge unknown">
            <span class="confidence-icon">⚪</span>
            <span class="confidence-text">{{ confidence }}</span>
          </div>
        {% endif %}
      </div>
      {% endif %}
    </section>

    <!-- Main Results Grid -->
    <div class="results-grid">
      
      <!-- Image Preview -->
      <div class="result-card image-card">
        <div class="card-header">
          <div class="card-icon">📷</div>
          <h3>Uploaded Image</h3>
        </div>
        <div class="image-container">
          <img class="result-image" src="data:{{ image_mime }};base64,{{ image_data }}" alt="Uploaded image preview">
          <div class="image-overlay">
            <div class="image-info">
              <span class="image-badge">AI Analysis</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Species Information -->
      {% if result.is_animal %}
      <div class="result-card species-card">
        <div class="card-header">
          <div class="card-icon">🔬</div>
          <h3>Species Analysis</h3>
        </div>
        <div class="species-details">
          <div class="detail-item">
            <div class="detail-label">Species</div>
            <div class="detail-value">{{ result.species or "Unknown" }}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Common Name</div>
            <div class="detail-value">{{ result.common_name or "Unknown" }}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Animal Type</div>
            <div class="detail-value">{{ result.animal_type or "Unknown" }}</div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Detection Status</div>
            <div class="detail-value status-positive">✅ Animal Confirmed</div>
          </div>
        </div>
      </div>
      {% else %}
      <div class="result-card no-animal-card">
        <div class="card-header">
          <div class="card-icon">🔍</div>
          <h3>Analysis Result</h3>
        </div>
        <div class="no-animal-content">
          <div class="no-animal-icon">❌</div>
          <h4>No Animal Detected</h4>
          <p>The AI analysis indicates this image does not contain an identifiable animal.</p>
        </div>
      </div>
      {% endif %}

      <!-- AI Information -->
      <div class="result-card ai-card">
        <div class="card-header">
          <div class="card-icon">🤖</div>
          <h3>AI Analysis</h3>
        </div>
        <div class="ai-info">
          <div class="ai-badge">
            <span class="ai-icon">🧠</span>
            <span class="ai-text">Together.ai</span>
          </div>
          <div class="model-info">
            <div class="model-name">Qwen2.5-VL Vision Model</div>
            <div class="model-desc">Advanced computer vision for species identification</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <a href="/" class="action-btn primary">
        <span class="btn-icon">🔍</span>
        <span class="btn-text">Identify Another Animal</span>
      </a>
      {% if result.is_animal and result.species and result.species != "Unknown" %}
      <a href="/map?species={{ result.species | urlencode }}&common_name={{ result.common_name | urlencode }}&animal_type={{ result.animal_type | urlencode }}" class="action-btn secondary">
        <span class="btn-icon">🗺️</span>
        <span class="btn-text">View Habitat Map</span>
      </a>
      {% endif %}
    </div>

  </main>
  <footer>Animal Species Identification • Auto file cleanup • Interactive habitat mapping</footer>
</body>
</html>